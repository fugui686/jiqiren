
import sys
import time
import re
import urllib
import threading
import configparser
import requests
from functools import partial
from bs4 import BeautifulSoup
from PyQt5.QtGui import QPixmap, QIcon, QFont
from PyQt5.QtCore import QTimer, QByteArray, Qt
from PyQt5.QtWidgets import (
    QApplication, QWidget, QVBoxLayout, QHBoxLayout, QLabel, QLineEdit,
    QTextEdit, QPushButton, QFormLayout, QMessageBox, QGroupBox, QStackedWidget,
    QListWidget, QListWidgetItem
)

# å…¨åˆæ”¯ä»˜/æ±‰åº­/ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªå•†æˆ·åå°
# å¤ªé˜³åŸ/æ˜“é€š/å…†é”‹/å¤§å®¶å‘/ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªå•†æˆ·åå°

# ========== å¯é€‰ï¼šå…³é—­ä¸å¿…è¦çš„å‘Šè­¦ ==========
try:
    import urllib3

    urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)
except Exception:
    pass

CONFIG_FILE = 'config.ini'

# === æ™ºèƒ½æ¨¡å¼è§¦å‘é¢‘ç‡ï¼ˆåˆ†é’Ÿï¼‰ ===
INTERVAL_MIN = 4  # æƒ³æ¯ N åˆ†é’Ÿè§¦å‘å°±å¡« Nï¼ˆä¾‹å¦‚ 2 / 5 / 10ï¼‰
ALIGN_MINUTE = 0  # åç§»åˆ†é’Ÿï¼ˆ0=åœ¨ 00,02,04â€¦è§¦å‘ï¼›1=åœ¨ 01,03,05â€¦è§¦å‘ï¼‰


class App(QWidget):
    def __init__(self):
        super().__init__()
        self.setWindowTitle("æ–¹èƒ½è´¹ç‡åŒæ­¥")
        self.resize(1050, 690)

        # åŠ è½½ base64 å›¾æ ‡ï¼ˆç¡®ä¿å­—ç¬¦ä¸²å®Œæ•´ï¼‰
        icon_base64 = "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//8iV///Ilf//yJX//8iV///Ilf//yJW//IiV/+HGFX/FQAAAAAAAAAAAAAAACFV/ychV//OIlf/5AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIVj/PSFW/88iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV//2Ilf/ryJX/5AiV/+1Ilf/+iJX//8iV//aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJEn/ByFW/5IiVv/+Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX/6UAAAAAAAAAAAAAAAAAAAAAAAAAACBV/xghVv/JIlf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf/TAAAAAAAAAAAAAAAAAAAAAAhWv8fIVf/3SJX//8iV///Ilf//yJX/+giVv+9IVf/oSJX/5YiV/+cIlb/tCJX/98iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yFX/84AAP8BAAAAAAAAAAAAAAAAIVn/FyJX/9wiV///Ilb/ySJV/28jVf8kAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACFS/x8hV/91Ilf/4CJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8hV//8IFf/OAAAAAAAAAAAAAAAACpV/wYiV//FIlf/rSJY/zQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACpV/wYgVv+OIlf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJW/4gAAAAAAAAAAAAAAAAAAAAAIVf/VSBT/zcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAhWf8XIlf/xSJX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AAAAAAAAIlb/dyJX//8hVv/PG1H/EwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIGD/CABV/wMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABxV/wkhV//lIVf/wh5a/xEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIVj/eiJX/5wkSf8HAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACFZ/xciVv9TAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAADAAAABgAAAAAQAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AUBA/wQqVf8GJEn/BzNm/wUAAP8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wEgUP8QHlX/MyJW/1MhWP9rIlf/fiNW/4whV/+SIVb/lCJX/40iVv9/I1f/ZiJW/0QgVf8YAAD/AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACFT/y4hWf8XAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAaTf8KIlf/TCFY/6AjV//VIVf/5SJX//AiV//4Ilf//iJX//8iV///Ilf//yJX//8iVv/+Ilf/9yJX/+siV//YIlf/liNX/ywAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJFv/KiJX/9AjV/9JAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcVf8JHVf/IyFW/3whV//fIlf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJW//ghVv+gIVf/Lxdd/wsAAAAAAAAAAAAAAAAAAAAAAAAAACpV/wYkWP9AIVj/3SJX//UhWP9jAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACNU/zoiVv+UIlf/5CJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf/6iJX/54gWP9XIlP/JSBg/xAcVf8bI1X/QiFX/4oiV//iIlf//yJX//YhVv9lAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbXv8TIlf/kCJX/+giV//8Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//4iV//xIlf/4SJX/9ohV//dIlf/6iJX//wiV///Ilf//yJX//EhV/9VAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQED/BCBY/zciV//IIlf//iJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yNX/+UkV/8yAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgUP8QIVb/cyJX/+ciV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJW/8MaTf8KAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACdi/w0iV/+VIlf/9iJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX/2EAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHFX/EiNW/6EiV///Ilf//yJX//8iV///Ilf//yJX//oiV//vIlf/5yJX/+EhV//dIlf/3CNX/90iV//hIlf/6CJX//EiV//8Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf/0kBA/wQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAjWP8dIVf/qCJX//8iV///Ilf//yJX//YhV//HIVf/mSJY/3EfWP9RIFj/NyJT/yUdWP8aIVn/FydY/xoiV/8mI1j/OiNY/1chVv98Ilf/qiJX/+EiV//+Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iVv/vIlf/TAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACdO/w0hWP+aIlf/+yJX//8iV//nIVb/iyRX/zIgVf8YHFX/CQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgP8CJFv/DiJa/yUhVv9zIlf/6CJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//0iV/+YGmb/CgAAAAAAAAAAAAAAAAAAAAAAAAAAAFX/AyFW/3MiV//zIlf/2SBW/3YaWf8UAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wEcVf8SIlf/gSJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX/9giU/8lAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIFf/WCJW/8MgV/9vHVj/GgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACJb/y0iV/+tIlf/+SJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX/74AQP8EAAAAAAAAAAAAAAAAAAAAAAAAAAAgWP8gIlb/WR1Y/xoAVf8DAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIFT/QCFX/94iV//9Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX/+AiWv8lAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBA/wQiVv9TIlj/6yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yFX/+0iVv9KAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACJX/2EiV//iIlf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//YhWP9jAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8BI1f/bCJX//EiV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//shVv90AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBA/wQhWP9jIlf/8SJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//8iV///Ilf//yJX//0hV/97AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA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AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACFX/1UiVv/PIFn/PwBA/wQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHFX/EiJX/58hVf8nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIlP/JSJV/w8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=="  # æ›¿æ¢æˆä½ çš„ base64
        icon_data = QByteArray.fromBase64(icon_base64.encode())

        # æ›´å¯é çš„å›¾æ ‡åŠ è½½æ–¹å¼
        pixmap = QPixmap()
        if not pixmap.loadFromData(icon_data, "ICO"):  # æ˜¾å¼æŒ‡å®šæ ¼å¼
            print("âŒ å›¾æ ‡åŠ è½½å¤±è´¥ï¼è¯·æ£€æŸ¥ base64 æ•°æ®æˆ–æ–‡ä»¶æ ¼å¼")
        else:
            self.setWindowIcon(QIcon(pixmap))  # è®¾ç½®çª—å£å’Œä»»åŠ¡æ å›¾æ ‡

        self.fields = {}  # ç»Ÿä¸€ç®¡ç†æ‰€æœ‰è¾“å…¥æ§ä»¶
        self.long_text_field = 'æ–¹èƒ½_cookie'

        self._build_ui()
        self._load_config()

        # æ–¹èƒ½ Cookie è½®è¯¢çº¿ç¨‹ï¼ˆä¿æŒç™»å½•æ€ï¼‰
        self.polling_thread = threading.Thread(target=self._poll_and_check_cookie_loop, daemon=True)
        self.polling_thread.start()

    # ===================== UI æ„å»º =====================
    def _build_ui(self):
        root = QHBoxLayout(self)

        # å·¦ä¾§å¯¼èˆª
        self.nav = QListWidget()
        self.nav.setFixedWidth(190)
        self.nav.addItem(QListWidgetItem("ğŸ¢ æ–¹èƒ½"))
        self.nav.addItem(QListWidgetItem("ğŸŒˆ å¤©é¸¿"))
        self.nav.addItem(QListWidgetItem("ğŸ’  å…¨åˆ"))
        self.nav.addItem(QListWidgetItem("ğŸŒ å¤ªé˜³åŸ"))
        self.nav.addItem(QListWidgetItem("ğŸ¨ æ±‰åº­"))
        self.nav.addItem(QListWidgetItem("ğŸ’ å°Šäº«"))
        self.nav.addItem(QListWidgetItem("ğŸ§­ æ˜“é€š"))
        self.nav.addItem(QListWidgetItem("âš¡ å…†é”‹"))
        self.nav.addItem(QListWidgetItem("ğŸ–ï¸ å¤§å®¶å‘"))
        self.nav.addItem(QListWidgetItem("ğŸ“˜ å…³äº"))
        self.nav.currentRowChanged.connect(self._on_nav_changed)

        # å³ä¾§é¡µé¢
        self.pages = QStackedWidget()
        self.pages.addWidget(self._build_page_fangneng())  # 0
        self.pages.addWidget(self._build_page_tianhong())  # 1
        self.pages.addWidget(self._build_page_quanhe())  # 2
        self.pages.addWidget(self._build_page_suncity())  # æ–°å¢ï¼šå¤ªé˜³åŸé¡µ
        self.pages.addWidget(self._build_page_hanting())  # æ–°å¢ï¼šæ±‰åº­é¡µ
        self.pages.addWidget(self._build_page_xinzunxiang())  # æ–°å¢ï¼šå°Šäº«é¡µ
        self.pages.addWidget(self._build_page_yitong())  # æ–°å¢ï¼šæ˜“é€šé¡µ
        self.pages.addWidget(self._build_page_zhaofeng())  # æ–°å¢ï¼šå…†é”‹é¡µ
        self.pages.addWidget(self._build_page_dajiafa())  # æ–°å¢ï¼šå¤§å®¶å‘é¡µ
        self.pages.addWidget(self._build_page_guanyu())  # æ–°å¢ï¼šå¤§å®¶å‘é¡µ

        root.addWidget(self.nav)
        root.addWidget(self.pages, 1)

        # é»˜è®¤é€‰ä¸­ç¬¬ä¸€é¡µ
        self.nav.setCurrentRow(0)

        # æ™ºèƒ½æ¨¡å¼å®šæ—¶å™¨
        self.smart_timer = QTimer()
        self.smart_timer.timeout.connect(self._check_and_run_smart_mode)
        self.smart_mode_enabled = False

        # â€”â€” é¢œè‰²ç»Ÿä¸€ç®¡ç†ï¼ˆå¯æŒ‰éœ€å¾®è°ƒï¼‰â€”â€”
        NAV_BG = "#f3f4f6"  # å·¦ä¾§å¯¼èˆªæµ…ç°ï¼ˆå’Œä½ å³ä¾§ç°åœ¨çš„æµ…ç°ç›¸è¿‘ï¼‰
        NAV_HOVER_BG = "#e8eaed"  # æ‚¬åœæ—¶ç¨æ·±
        # é€‰ä¸­æ—¶çš„å·¦ä¾§é¢œè‰²ï¼Œç”¨äºæ¸å˜èµ·ç‚¹
        NAV_GRADIENT_START = "#f9d8d8"
        # é€‰ä¸­æ—¶çš„å³ä¾§é¢œè‰²ï¼Œç”¨äºæ¸å˜ç»ˆç‚¹ (ä½¿ç”¨ç™½è‰²æˆ–æ¥è¿‘èƒŒæ™¯è‰²)
        NAV_GRADIENT_END = "#ffffff"
        TEXT_DEFAULT = "#000000"  # é»˜è®¤é»‘å­—
        TEXT_SELECTED = "#d92020"  # é€‰ä¸­åçº¢å­—

        # æ‚¬åœç”Ÿæ•ˆéœ€è¦å¼€å¯é¼ æ ‡è·Ÿè¸ª
        self.nav.setMouseTracking(True)

        # å·¦ä¾§å¯¼èˆªæ ·å¼
        self.nav.setStyleSheet(f"""
        QListWidget {{
            background: {NAV_BG};
            border: none;
            outline: 0;
        }}
        QListWidget::item {{
            height: 36px;
            padding: 6px 12px;
            color: {TEXT_DEFAULT};
            border: none;
        }}
        QListWidget::item:hover {{
            /* ä½¿ç”¨æ¸å˜ä½œä¸ºæ‚¬åœæ•ˆæœ */
            background: qlineargradient(x1:0, y1:0, x2:1, y2:0,
                                        stop:0 {NAV_HOVER_BG}, 
                                        stop:1 {NAV_GRADIENT_END});
        }}
        /* é€‰ä¸­é¡¹çš„æ¸å˜èƒŒæ™¯ */
        QListWidget::item:selected,
        QListWidget::item:selected:active,
        QListWidget::item:selected:!active {{
            background: qlineargradient(x1:0, y1:0, x2:1, y2:0,
                                        stop:0 {NAV_GRADIENT_START}, 
                                        stop:1 {NAV_GRADIENT_END});
            color: {TEXT_SELECTED};
        }}

        /*ï¼ˆå¯é€‰ï¼‰æ»šåŠ¨æ¡æ›´ç»†ä¸€ç‚¹ï¼Œé£æ ¼æ›´ç®€æ´ */
        QScrollBar:vertical {{
            background: transparent;
            width: 8px;
            margin: 0px;
        }}
        QScrollBar::handle:vertical {{
            background: #c7c9cc;
            border-radius: 4px;
            min-height: 20px;
        }}
        QScrollBar::add-line:vertical, QScrollBar::sub-line:vertical {{
            height: 0px;
        }}
        """)

        self.pages.setStyleSheet("""
        /* å³ä¾§é¡µé¢å®¹å™¨èƒŒæ™¯ï¼šç™½è‰² (ä½ åŸæ¥çš„æ ·å¼) */
        QStackedWidget { background: #ffffff; }

        /* ================== æ–°å¢çš„æŒ‰é’® (QPushButton) æ ·å¼ ================== */
        QPushButton {
            background-color: white;            /* ç™½è‰²èƒŒæ™¯ */
            color: #3498db;                     /* è“è‰²æ–‡å­— */
            border: 1px solid #3498db;          /* è“è‰²è¾¹æ¡† */
            border-radius: 8px;                 /* åœ†è§’åŠå¾„8px */
            padding: 10px 16px;                 /* å†…è¾¹è· */
            font-size: 16px;                    /* å­—ä½“å¤§å° */
            font-weight: bold;                 /* å­—ä½“åŠ ç²— */
            letter-spacing: 0.5px;              /* å­—ç¬¦é—´è· */
        }

        QPushButton:hover {
            background-color: #ecf5fb;          /* é¼ æ ‡æ‚¬åœæ—¶æµ…è“èƒŒæ™¯ï¼ˆè§†è§‰åé¦ˆï¼‰ */
            color: #2980b9;                     /* æ‚¬åœæ—¶æ–‡å­—é¢œè‰²ç¨å¾®åŠ æ·± */
            border: 1px solid #2980b9;          /* è¾¹æ¡†é¢œè‰²ä¹Ÿç¨å¾®åŠ æ·± */
        }

        QPushButton:pressed {
            background-color: #d6eaf8;          /* æŒ‰ä¸‹æ—¶æ›´æ·±ä¸€ç‚¹çš„æµ…è“èƒŒæ™¯ */
            /* è°ƒæ•´ padding ä»¥æ¨¡æ‹ŸæŒ‰å‹æ„Ÿ */
            padding-left: 14px;                 
            padding-top: 12px;
        }

        QPushButton:disabled {
            background-color: #f0f0f0;          /* ç¦ç”¨æ—¶èƒŒæ™¯ç°è‰² */
            color: #bdc3c7;                     /* ç¦ç”¨æ—¶å­—ä½“æµ…ç° */
            border: 1px solid #ccc;             /* è¾¹æ¡†å˜æµ…ç° */
        }

        /* ================== æ–°å¢çš„è¾“å…¥æ§ä»¶ (QLineEdit, QComboBox, QDateTimeEdit) æ ·å¼ ================== */
        QLineEdit, QComboBox, QDateTimeEdit {
            padding: 6px;                      /* è¾“å…¥æ§ä»¶å†…è¾¹è·ï¼ˆ6pxï¼‰ */
            border: 1px solid #ccc;            /* è¾¹æ¡†é¢œè‰²ä¸ºæµ…ç°è‰² */
            border-radius: 5px;                /* åœ†è§’ï¼ˆ5pxï¼‰ */
            font-size: 13px;                   /* å­—ä½“å¤§å°ï¼ˆ20pxï¼‰ */
        }

        /* ç„¦ç‚¹çŠ¶æ€ (æ–°å¢) - å½“ç”¨æˆ·ç‚¹å‡»ï¼ˆè·å¾—ç„¦ç‚¹ï¼‰æ—¶è¾¹æ¡†å˜ä¸ºè“è‰² */
        QLineEdit:focus, QComboBox:focus, QDateTimeEdit:focus {
        border: 1px solid #3498db;         /* è“è‰²è¾¹æ¡† */
        /* ä¹Ÿå¯ä»¥å¢åŠ ä¸€ç‚¹é˜´å½±æ¥å¼ºåŒ–æ•ˆæœ */
        /* outline: none;  /* æŸäº›ç³»ç»Ÿå¯èƒ½éœ€è¦è¿™ä¸ªæ¥ç¦ç”¨é»˜è®¤ç„¦ç‚¹æ¡† */
        }

        /* ================== æ–°å¢çš„ç»„æ¡† (QGroupBox) æ ·å¼ ================== */
        QGroupBox {
            border: 1px solid #aaa;  /* ç»„æ¡†è¾¹æ¡†é¢œè‰²å’Œå®½åº¦ */
            border-radius: 8px;  /* ç»„æ¡†åœ†è§’ */
            margin-top: 6px;  /* ç»„æ¡†é¡¶éƒ¨å¤–è¾¹è·ï¼Œä¸ºæ ‡é¢˜è…¾å‡ºç©ºé—´ */
        }

        QGroupBox::title {
            subcontrol-origin: margin;  /* ç»„æ¡†æ ‡é¢˜åŸºäºè¾¹è·å®šä½ */
            subcontrol-position: top center;  /* ç»„æ¡†æ ‡é¢˜å±…ä¸­ */
            padding: 0 6px;  /* ç»„æ¡†æ ‡é¢˜å†…è¾¹è· */
            font-size: 15px;  /* ç»„æ¡†æ ‡é¢˜å­—ä½“å¤§å° */
            font-weight: bold;  /* ç»„æ¡†æ ‡é¢˜åŠ ç²— */
        }
        """)

        from PyQt5.QtGui import QFont, QFontMetrics
        font = QFont()
        font.setPointSize(12)  # ç”¨â€œç‚¹â€è€Œä¸æ˜¯åƒç´ ï¼ŒDPI é€‚é…æ›´å¥½
        self.nav.setFont(font)

        fm = QFontMetrics(font)
        item_h = fm.height() + 12  # ç»™ä¸Šä¸‹å„ç•™ç‚¹ padding
        self.nav.setStyleSheet(self.nav.styleSheet() + f"""
        QListWidget::item {{ height: {item_h}px; }}
        """)

    def _on_nav_changed(self, idx: int):
        self.pages.setCurrentIndex(idx)

    # ========== Page 1ï¼šæ–¹èƒ½é…ç½® ==========
    def _build_page_fangneng(self) -> QWidget:
        page = QWidget()
        main_layout = QVBoxLayout(page)

        group_fn = QGroupBox("ğŸ¢ æ–¹èƒ½å¹³å°é…ç½®")
        form_fn = QFormLayout()
        for name in ['æ–¹èƒ½è´¦å·', 'æ–¹èƒ½å¯†ç ', 'æ–¹èƒ½éªŒè¯ç ', 'æ–¹èƒ½åŸŸå', 'user-agent', 'æ–¹èƒ½_cookie']:
            label = QLabel(name)
            widget = QTextEdit() if name == self.long_text_field else QLineEdit()

            if name in ('æ–¹èƒ½å¯†ç ',) and isinstance(widget, QLineEdit):
                widget.setEchoMode(QLineEdit.Password)

            if name == self.long_text_field:
                widget.setFixedHeight(80)

            form_fn.addRow(label, widget)
            self.fields[name] = widget
        group_fn.setLayout(form_fn)

        group_tg = QGroupBox("ğŸ¤– Telegram é€šçŸ¥")
        form_tg = QFormLayout()
        for name in ['æœºå™¨äººToken', 'ç¾¤ç»„ID']:
            label = QLabel(name)
            widget = QLineEdit()
            form_tg.addRow(label, widget)
            self.fields[name] = widget
        group_tg.setLayout(form_tg)

        btn_row = QHBoxLayout()
        btn_save = QPushButton("ğŸ’¾ ä¿å­˜é…ç½®")
        btn_save.clicked.connect(self._save_config)

        btn_run = QPushButton("ğŸš€ æ‰‹åŠ¨è¿è¡Œ")
        btn_run.clicked.connect(self._run_all_sync_threaded)

        # å¯åŠ¨æ™ºèƒ½æ¨¡å¼æŒ‰é’®
        self.btn_start_smart = QPushButton(f"ğŸ§  å¯åŠ¨æ™ºèƒ½æ¨¡å¼")
        self.btn_start_smart.clicked.connect(self._start_smart_mode)

        # åœæ­¢æ™ºèƒ½æ¨¡å¼æŒ‰é’®
        self.btn_stop_smart = QPushButton("ğŸ›‘ åœæ­¢æ™ºèƒ½æ¨¡å¼")
        self.btn_stop_smart.clicked.connect(self._stop_smart_mode)
        # åˆå§‹æ—¶ï¼Œåœæ­¢æŒ‰é’®åº”ä¸ºç¦ç”¨çŠ¶æ€
        self.btn_stop_smart.setEnabled(False)

        btn_login = QPushButton("ğŸ” ç™»å½•æ–¹èƒ½")
        btn_login.clicked.connect(self._login_fangneng_and_update_cookie)

        btn_row.addWidget(btn_save)
        btn_row.addWidget(btn_run)
        btn_row.addWidget(self.btn_start_smart)
        btn_row.addWidget(self.btn_stop_smart)
        btn_row.addWidget(btn_login)
        btn_row.addStretch()

        main_layout.addWidget(group_fn)
        main_layout.addWidget(group_tg)
        main_layout.addLayout(btn_row)
        main_layout.addStretch()
        return page

    # ========== Page 2ï¼šå¤©é¸¿é…ç½® ==========
    def _build_page_tianhong(self) -> QWidget:
        page = QWidget()
        main_layout = QVBoxLayout(page)

        group_th = QGroupBox("ğŸŒˆ å¤©é¸¿å¹³å°è®¾ç½®")
        form_th = QFormLayout()
        for name in ['å¤©é¸¿åŸŸå(port)', 'å¤©é¸¿cookie']:
            label = QLabel(name)
            widget = QLineEdit()
            form_th.addRow(label, widget)
            self.fields[name] = widget
        group_th.setLayout(form_th)

        #  å¯ç”¨å¯è®¾ç½®æ ‡ç­¾
        # tips = QLabel("è¯´æ˜ï¼šæœ¬é¡µä»…é…ç½®é¡¹ã€‚ç»Ÿä¸€ç‚¹å‡»â€œæ–¹èƒ½é…ç½®â€é¡µçš„ã€ä¿å­˜é…ç½®ã€ã€è¿è¡Œç¨‹åºã€ã€æ™ºèƒ½æ¨¡å¼ã€ç®¡ç†ã€‚")
        # tips.setWordWrap(True)

        main_layout.addWidget(group_th)
        # main_layout.addWidget(tips)
        main_layout.addStretch()
        return page

    # ========== Page 3ï¼šå…¨åˆæ”¯ä»˜é…ç½® ==========
    def _build_page_quanhe(self) -> QWidget:
        page = QWidget()
        main_layout = QVBoxLayout(page)

        group_qh = QGroupBox("ğŸ’  å…¨åˆæ”¯ä»˜è®¾ç½®")
        form_qh = QFormLayout()
        for name in ['å…¨åˆåŸŸå(port)', 'å…¨åˆcookie']:
            label = QLabel(name)
            widget = QLineEdit()
            form_qh.addRow(label, widget)
            self.fields[name] = widget
        group_qh.setLayout(form_qh)

        main_layout.addWidget(group_qh)
        main_layout.addStretch()
        return page

    # ========== Page 4ï¼šå¤ªé˜³åŸæ”¯ä»˜é…ç½® ==========
    def _build_page_suncity(self) -> QWidget:
        page = QWidget()
        main_layout = QVBoxLayout(page)

        group_sc = QGroupBox("ğŸŒ å¤ªé˜³åŸè®¾ç½®")
        form_sc = QFormLayout()
        for name in ['å¤ªé˜³åŸåŸŸå(port)', 'å¤ªé˜³åŸaccess_token']:
            label = QLabel(name)
            widget = QLineEdit()
            form_sc.addRow(label, widget)
            self.fields[name] = widget
        group_sc.setLayout(form_sc)

        main_layout.addWidget(group_sc)
        main_layout.addStretch()
        return page

    # ========== Page 5ï¼šæ±‰åº­æ”¯ä»˜é…ç½® ==========
    def _build_page_hanting(self) -> QWidget:
        page = QWidget()
        main_layout = QVBoxLayout(page)

        group_ht = QGroupBox("ğŸ¨ æ±‰åº­è®¾ç½®")
        form_ht = QFormLayout()
        for name in ['æ±‰åº­åŸŸå(port)', 'æ±‰åº­cookie']:
            label = QLabel(name)
            widget = QLineEdit()
            form_ht.addRow(label, widget)
            self.fields[name] = widget
        group_ht.setLayout(form_ht)

        main_layout.addWidget(group_ht)
        main_layout.addStretch()
        return page

    # ========== Page 6ï¼šå°Šäº«æ”¯ä»˜é…ç½® ==========
    def _build_page_xinzunxiang(self) -> QWidget:
        page = QWidget()
        main_layout = QVBoxLayout(page)

        group = QGroupBox("ğŸ’ å°Šäº«è®¾ç½®")
        form = QFormLayout()
        for name in ['å°Šäº«åŸŸå(port)', 'å°Šäº«itoken']:
            label = QLabel(name)
            widget = QLineEdit()
            form.addRow(label, widget)
            self.fields[name] = widget
        group.setLayout(form)

        main_layout.addWidget(group)
        main_layout.addStretch()
        return page

    # ========== Page 7ï¼šæ˜“é€šæ”¯ä»˜é…ç½® ==========
    def _build_page_yitong(self) -> QWidget:
        page = QWidget()
        main_layout = QVBoxLayout(page)

        group = QGroupBox("ğŸ§­ æ˜“é€šè®¾ç½®")
        form = QFormLayout()
        for name in ['æ˜“é€šåŸŸå(port)', 'æ˜“é€šaccess_token']:
            label = QLabel(name)
            widget = QLineEdit()
            form.addRow(label, widget)
            self.fields[name] = widget
        group.setLayout(form)

        main_layout.addWidget(group)
        main_layout.addStretch()
        return page

    # ========== Page 8ï¼šå…†é”‹æ”¯ä»˜é…ç½® ==========
    def _build_page_zhaofeng(self) -> QWidget:
        page = QWidget()
        main_layout = QVBoxLayout(page)

        group = QGroupBox("âš¡ å…†é”‹è®¾ç½®")
        form = QFormLayout()
        for name in ['å…†é”‹åŸŸå(port)', 'å…†é”‹access_token']:
            label = QLabel(name)
            widget = QLineEdit()
            form.addRow(label, widget)
            self.fields[name] = widget
        group.setLayout(form)

        main_layout.addWidget(group)
        main_layout.addStretch()
        return page

    # ========== Page 8ï¼šå¤§å®¶å‘æ”¯ä»˜é…ç½® ==========
    def _build_page_dajiafa(self) -> QWidget:
        page = QWidget()
        main_layout = QVBoxLayout(page)

        group = QGroupBox("ğŸ–ï¸ å¤§å®¶å‘è®¾ç½®")
        form = QFormLayout()
        for name in ['å¤§å®¶å‘åŸŸå(port)', 'å¤§å®¶å‘access_token']:
            label = QLabel(name)
            widget = QLineEdit()
            form.addRow(label, widget)
            self.fields[name] = widget
        group.setLayout(form)

        main_layout.addWidget(group)
        main_layout.addStretch()
        return page

        # ==================== å…³äºéƒ¨åˆ† ====================
    def _build_page_guanyu(self) -> QWidget:
        page = QWidget()
        main_layout = QVBoxLayout(page)

        # ==================== é¡¶éƒ¨ä¿¡æ¯éƒ¨åˆ† ====================

        # æ ‡é¢˜ï¼šå…³äºæ•°æ®ç²¾çµ
        title = QLabel("å…³äºæœ¬å·¥å…·")
        font_title = QFont()
        font_title.setPointSize(18)
        font_title.setBold(True)
        title.setFont(font_title)
        main_layout.addWidget(title)

        # æ·»åŠ ä¸€ä¸ªå°çš„åˆ†éš”
        main_layout.addSpacing(20)

        # ç‰ˆæœ¬ä¿¡æ¯å’Œæ›´æ–°æ—¥æœŸ
        version_info = QLabel(
            "ç‰ˆæœ¬ï¼š<span style='color: #d92020; font-weight: bold;'>v1.0.0</span> æ›´æ–°æ—¥æœŸï¼š2025-10-16")
        font_version = QFont()
        font_version.setPointSize(12)
        version_info.setFont(font_version)
        # ä½¿ç”¨ setOpenExternalLinks(True) å…è®¸ HTML é“¾æ¥ï¼Œä½†è¿™é‡Œä¸»è¦ç”¨å®ƒæ¥è§£æ <span> æ ‡ç­¾çš„æ ·å¼
        version_info.setTextFormat(Qt.TextFormat.RichText)
        main_layout.addWidget(version_info)

        # æ·»åŠ ä¸€ä¸ªå°çš„åˆ†éš”
        main_layout.addSpacing(20)

        # ==================== å£°æ˜éƒ¨åˆ† ====================

        # å£°æ˜æ ‡é¢˜
        declaration_title = QLabel("å£°æ˜:")
        font_declaration_title = QFont()
        font_declaration_title.setPointSize(14)
        font_declaration_title.setBold(True)
        declaration_title.setFont(font_declaration_title)
        main_layout.addWidget(declaration_title)

        # å£°æ˜æ­£æ–‡ - ç¬¬ä¸€æ®µ
        declaration_text_1 = """
        æœ¬è½¯ä»¶ä»…ä¾›å…·å¤‡åå°è®¿é—®æƒé™ä¸”å·²è·æˆæƒçš„ç”¨æˆ·åœ¨åˆè§„å‰æä¸‹ä½¿ç”¨ï¼Œä¸»è¦ç”¨äºåŒæ­¥ä¸‰å•†æˆ·æ–¹è´¹ç‡åˆ°æ–¹èƒ½æ”¯ä»˜åå°ã€‚ä½¿ç”¨è€…åº”ç¡®è®¤/ä¿è¯æ•°æ®ä¸è´¦å·æ¥æºåˆè§„ã€æˆæƒå……åˆ†ï¼Œå¹¶å¯¹è‡ªèº«æ“ä½œåŠç»“æœæ‰¿æ‹…å…¨éƒ¨è´£ä»»ã€‚
        """
        declaration_label_1 = QLabel(declaration_text_1.strip())
        declaration_label_1.setWordWrap(True)
        declaration_label_1.setFont(QFont("å¾®è½¯é›…é»‘", 12))  # ä¿æŒå­—ä½“å’Œå¤§å°ä¸€è‡´
        main_layout.addWidget(declaration_label_1)

        # å£°æ˜æ­£æ–‡ - ç¬¬äºŒæ®µ
        declaration_text_2 = """
        å› æˆæƒä¸è¶³æˆ–è¿è§„å¯¼è‡´çš„ä»»ä½•æŸå¤±ã€å¤„ç½šç­‰ç”±ä½¿ç”¨è€…è‡ªè¡Œæ‰¿æ‹…ã€‚æœ¬è½¯ä»¶æŒ‰â€œç°çŠ¶â€æä¾›ï¼Œä¸ä½œä»»ä½•æ˜ç¤ºæˆ–é»˜ç¤ºæ‹…ä¿ï¼›ä½œè€…å¯¹å› ä½¿ç”¨æˆ–æ— æ³•ä½¿ç”¨æœ¬è½¯ä»¶é€ æˆçš„ä»»ä½•ç›´æ¥æˆ–é—´æ¥æŸå¤±ä¸æ‰¿æ‹…è´£ä»»ã€‚æœ¬è½¯ä»¶ä¸ç›¸å…³å¹³å°/å•†æˆ·/æ”¯ä»˜æœºæ„æ— éš¶å±æˆ–åˆä½œå…³ç³»ã€‚
        """
        declaration_label_2 = QLabel(declaration_text_2.strip())
        declaration_label_2.setWordWrap(True)
        declaration_label_2.setFont(QFont("å¾®è½¯é›…é»‘", 12))
        main_layout.addWidget(declaration_label_2)

        # å£°æ˜æ­£æ–‡ - ç¬¬ä¸‰æ®µ
        declaration_text_3 = """
        ç»§ç»­ä½¿ç”¨å³è¡¨ç¤ºæ‚¨å·²é˜…è¯»ã€ç†è§£å¹¶åŒæ„æœ¬å£°æ˜ã€‚
        """
        declaration_label_3 = QLabel(declaration_text_3.strip())
        declaration_label_3.setWordWrap(True)
        declaration_label_3.setFont(QFont("å¾®è½¯é›…é»‘", 12))
        main_layout.addWidget(declaration_label_3)

        # ==================== ç»“æŸå¸ƒå±€ ====================

        # æ·»åŠ ä¼¸å±•å™¨ï¼Œå°†å†…å®¹æ¨åˆ°é¡¶éƒ¨
        main_layout.addStretch()

        # è®¾ç½®é¡µé¢èƒŒæ™¯è‰²ä¸ºç™½è‰²ï¼Œä¸å³ä¾§é¡µé¢å®¹å™¨èƒŒæ™¯è‰²ä¿æŒä¸€è‡´ï¼ˆå¦‚æœçˆ¶å®¹å™¨æ²¡æœ‰å…¨å±€è®¾ç½®çš„è¯ï¼‰
        # page.setStyleSheet("background-color: white;")

        return page

    # ===================== æ™ºèƒ½æ¨¡å¼ =====================
    def _start_smart_mode(self):
        """
        å¯åŠ¨æ™ºèƒ½æ¨¡å¼ï¼Œè®¾ç½®å®šæ—¶å™¨å¹¶æ›´æ–°æŒ‰é’®çŠ¶æ€ã€‚
        """
        # çŠ¶æ€æ›´æ–°
        self.smart_mode_enabled = True

        # æŒ‰é’®çŠ¶æ€æ›´æ–°
        self.btn_start_smart.setEnabled(False)  # å¯åŠ¨åç¦ç”¨å¯åŠ¨æŒ‰é’®
        self.btn_stop_smart.setEnabled(True)  # å¯åŠ¨åå¯ç”¨åœæ­¢æŒ‰é’®

        # å®šæ—¶å™¨å¯åŠ¨
        # æ³¨æ„ï¼šself.smart_timer åº”è¯¥æ˜¯ QTimer çš„å®ä¾‹
        self.smart_timer.start(10_000)  # æ¯ 10 ç§’æ£€æŸ¥ä¸€æ¬¡æ˜¯å¦åˆ°è§¦å‘çª—å£

        # æç¤ºä¿¡æ¯
        QMessageBox.information(self, "æ™ºèƒ½æ¨¡å¼", f"âœ… æ™ºèƒ½æ¨¡å¼å·²å¯åŠ¨ï¼Œå°†æ¯ {INTERVAL_MIN} åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ã€‚")

    def _stop_smart_mode(self):
        """
        åœæ­¢æ™ºèƒ½æ¨¡å¼ï¼Œåœæ­¢å®šæ—¶å™¨å¹¶æ›´æ–°æŒ‰é’®çŠ¶æ€ã€‚
        """
        # çŠ¶æ€æ›´æ–°
        self.smart_mode_enabled = False

        # æŒ‰é’®çŠ¶æ€æ›´æ–°
        self.btn_start_smart.setEnabled(True)  # åœæ­¢åå¯ç”¨å¯åŠ¨æŒ‰é’®
        self.btn_stop_smart.setEnabled(False)  # åœæ­¢åç¦ç”¨åœæ­¢æŒ‰é’®

        # å®šæ—¶å™¨åœæ­¢
        self.smart_timer.stop()

        # æç¤ºä¿¡æ¯
        QMessageBox.information(self, "æ™ºèƒ½æ¨¡å¼", "â›”ï¸ æ™ºèƒ½æ¨¡å¼å·²åœæ­¢ã€‚")

    def _check_and_run_smart_mode(self):
        now = time.localtime()
        if (now.tm_min - ALIGN_MINUTE) % INTERVAL_MIN == 0 and now.tm_sec < 10:
            print("â° æ™ºèƒ½æ¨¡å¼è§¦å‘ï¼Œå¼€å§‹è¿è¡Œç¨‹åºï¼ˆç»Ÿä¸€åŒæ­¥ï¼šå¤©é¸¿/å…¨åˆ â†’ æ–¹èƒ½ï¼‰...")
            self._run_all_sync_threaded()

    # ============== æ–¹èƒ½ Cookie è‡ªåŠ¨ç»´æŠ¤ï¼ˆä¿æŒç™»å½•æ€ï¼‰ ==============
    def _poll_and_check_cookie_loop(self):
        while True:
            try:
                domain = self._get_value('æ–¹èƒ½åŸŸå')
                user_agent = self._get_value('user-agent')
                current_cookie = self._get_value('æ–¹èƒ½_cookie', is_text=True).strip()

                if not domain or not current_cookie:
                    print("â³ [è½®è¯¢] Cookie æˆ–åŸŸåä¸ºç©ºï¼Œè·³è¿‡æœ¬è½®ã€‚")
                    time.sleep(60)
                    continue

                headers = {
                    'user-agent': user_agent,
                    'x-requested-with': 'XMLHttpRequest',
                    'cookie': current_cookie
                }

                url = f"https://{domain}/PassManage/Pass/GetPageListJson?page=1&limit=10"
                res = requests.get(url, headers=headers, timeout=10)
                print("ğŸ“¦ [è½®è¯¢] æ–¹èƒ½å“åº”çŠ¶æ€ç ï¼š", res.status_code)

                set_cookie = res.headers.get("Set-Cookie", "")
                match = re.search(r'UserToken=([^;]+)', set_cookie)
                if match:
                    new_token = match.group(1)
                    new_cookie = f"UserToken={new_token}"

                    decoded_old = urllib.parse.unquote(current_cookie.replace("UserToken=", "").strip())
                    decoded_new = urllib.parse.unquote(new_token.strip())

                    if decoded_new != decoded_old:
                        print("ğŸ” [è½®è¯¢] æ£€æµ‹åˆ° Cookie æ›´æ–°ï¼Œè‡ªåŠ¨æ›¿æ¢")
                        QTimer.singleShot(0, partial(self._update_cookie_ui, new_cookie))
                        QTimer.singleShot(0, partial(QMessageBox.information,
                                                     self, "Cookie æ›´æ–°", "ğŸ” æ£€æµ‹åˆ°æ–°çš„ UserTokenï¼Œå·²è‡ªåŠ¨æ›´æ–°ï¼"))
                    else:
                        print("âœ… [è½®è¯¢] Cookie å†…å®¹ä¸€è‡´")
                else:
                    print("â„¹ï¸ [è½®è¯¢] å“åº”ä¸­æ—  Set-Cookie")

            except Exception as e:
                print("âš ï¸ [è½®è¯¢] æ£€æŸ¥å¼‚å¸¸ï¼š", str(e))

            print("ğŸ•’ [è½®è¯¢] ç­‰å¾… 5 åˆ†é’Ÿåç»§ç»­...")
            time.sleep(5 * 60)

    def _update_cookie_ui(self, cookie_value: str):
        w = self.fields.get('æ–¹èƒ½_cookie')
        if isinstance(w, QTextEdit):
            w.setPlainText(cookie_value)

    # ============== æ–¹èƒ½ç™»å½•è·å– Cookie ==============
    def _login_fangneng_and_update_cookie(self):
        username = self._get_value('æ–¹èƒ½è´¦å·')
        password = self._get_value('æ–¹èƒ½å¯†ç ')
        googlecode = self._get_value('æ–¹èƒ½éªŒè¯ç ')
        domain = self._get_value('æ–¹èƒ½åŸŸå')
        user_agent = self._get_value('user-agent')

        if not username or not password or not googlecode or not domain or not user_agent:
            QMessageBox.critical(self, "é”™è¯¯", " è¯·å…ˆå¡«å†™å®Œæ•´çš„æ–¹èƒ½é…ç½®")
            return

        session = requests.Session()
        headers = {
            'user-agent': user_agent,
            'x-requested-with': 'XMLHttpRequest',
        }

        try:
            session.get(f"https://{domain}/Home/Login", headers=headers, timeout=5)
            data = {'username': username, 'password': password, 'googlecode': googlecode}
            res = session.post(f"https://{domain}/Home/LoginJson", headers=headers, data=data, timeout=10)
            token = session.cookies.get("UserToken")
            if token:
                self._set_value('æ–¹èƒ½_cookie', f"UserToken={token}", is_text=True)
                QMessageBox.information(self, "ç™»å½•æˆåŠŸ", f"âœ… ç™»å½•æˆåŠŸï¼Œå·²è·å– UserTokenã€‚\n{token}")
            else:
                QMessageBox.critical(self, "ç™»å½•å¤±è´¥", f"âŒ ç™»å½•å¤±è´¥ï¼Œå“åº”å†…å®¹ï¼š\n{res.text}")
        except Exception as e:
            QMessageBox.critical(self, "å¼‚å¸¸", f"âš ï¸ ç™»å½•è¯·æ±‚å¼‚å¸¸ï¼š{str(e)}")

    # ===================== é…ç½®å­˜å–ï¼ˆç»Ÿä¸€ä¿å­˜æ‰€æœ‰é¡µé¢ï¼‰ =====================
    def _save_config(self):
        config = configparser.ConfigParser(interpolation=None)
        config['DEFAULT'] = {
            k: (v.toPlainText() if isinstance(v, QTextEdit) else v.text())
            for k, v in self.fields.items()
        }
        try:
            with open(CONFIG_FILE, 'w', encoding='utf-8') as f:
                config.write(f)
            QMessageBox.information(self, "æˆåŠŸ", "âœ… é…ç½®å·²ä¿å­˜")
        except Exception as e:
            QMessageBox.critical(self, "é”™è¯¯", f"ä¿å­˜å¤±è´¥: {e}")

    def _load_config(self):
        config = configparser.ConfigParser(interpolation=None)
        try:
            config.read(CONFIG_FILE, encoding='utf-8')
            for k, w in self.fields.items():
                if k in config['DEFAULT']:
                    if isinstance(w, QTextEdit):
                        w.setPlainText(config['DEFAULT'][k])
                    else:
                        w.setText(config['DEFAULT'][k])
        except Exception as e:
            QMessageBox.warning(self, "è­¦å‘Š", f"åŠ è½½é…ç½®å¤±è´¥: {e}")

    # ===================== å·¥å…·å‡½æ•° =====================
    def _get_value(self, key: str, is_text: bool = False) -> str:
        w = self.fields.get(key)
        if not w:
            return ""
        if is_text and isinstance(w, QTextEdit):
            return w.toPlainText()
        return w.text() if hasattr(w, 'text') else ""

    def _set_value(self, key: str, val: str, is_text: bool = False):
        w = self.fields.get(key)
        if not w:
            return
        if is_text and isinstance(w, QTextEdit):
            w.setPlainText(val)
        elif hasattr(w, 'setText'):
            w.setText(val)

    # ===================== Telegram =====================
    def _send_telegram(self, message: str):
        bot_token = self._get_value('æœºå™¨äººToken')
        chat_id = self._get_value('ç¾¤ç»„ID')
        if not bot_token or not chat_id:
            print("âš ï¸ æœªé…ç½® Telegram ä¿¡æ¯ï¼Œè·³è¿‡å‘é€ã€‚")
            return
        url = f'https://api.telegram.org/bot{bot_token}/sendMessage'
        data = {'chat_id': chat_id, 'text': message, 'parse_mode': 'Markdown'}
        try:
            requests.post(url, data=data, timeout=8)
        except Exception as e:
            print(f"å‘é€ Telegram æ¶ˆæ¯å¤±è´¥: {e}")

    # ===================== ç»Ÿä¸€â€œè¿è¡Œç¨‹åºâ€å…¥å£ =====================
    def _run_all_sync_threaded(self):
        t = threading.Thread(target=self._run_all_sync, daemon=True)
        t.start()

    def _run_all_sync(self):
        self._send_telegram("âœ… ç¨‹åºå¯åŠ¨ï¼š\nï¼ˆå¤©é¸¿/å…¨åˆ/å¤ªé˜³åŸ/æ±‰åº­/å°Šäº«/æ˜“é€š/å…†é”‹/å¤§å®¶å‘ â†’ æ–¹èƒ½ï¼‰")
        # å¤©é¸¿ â†’ æ–¹èƒ½
        try:
            self._run_tianhong_to_fangneng()
        except Exception as e:
            print(f"âŒ å¤©é¸¿â†’æ–¹èƒ½ åŒæ­¥å¼‚å¸¸ï¼š{e}")
        # å…¨åˆ â†’ æ–¹èƒ½
        try:
            self._run_quanhe_to_fangneng()
        except Exception as e:
            print(f"âŒ å…¨åˆâ†’æ–¹èƒ½ åŒæ­¥å¼‚å¸¸ï¼š{e}")

        # å¤ªé˜³åŸ â†’ æ–¹èƒ½
        try:
            self._run_suncity_to_fangneng()
        except Exception as e:
            print(f"âŒ å¤ªé˜³åŸâ†’æ–¹èƒ½ åŒæ­¥å¼‚å¸¸ï¼š{e}")

        # æ±‰åº­ â†’ æ–¹èƒ½
        try:
            self._run_hanting_to_fangneng()
        except Exception as e:
            print(f"âŒ æ±‰åº­â†’æ–¹èƒ½ åŒæ­¥å¼‚å¸¸ï¼š{e}")

        # å°Šäº« â†’ æ–¹èƒ½
        try:
            self._run_xinzunxiang_to_fangneng()
        except Exception as e:
            print(f"âŒ å°Šäº«â†’æ–¹èƒ½ åŒæ­¥å¼‚å¸¸ï¼š{e}")

        # æ˜“é€š â†’ æ–¹èƒ½
        try:
            self._run_yitong_to_fangneng()
        except Exception as e:
            print(f"âŒ æ˜“é€šâ†’æ–¹èƒ½ åŒæ­¥å¼‚å¸¸ï¼š{e}")

        # å…†é”‹ â†’ æ–¹èƒ½
        try:
            self._run_zhaofeng_to_fangneng()
        except Exception as e:
            print(f"âŒ å…†é”‹â†’æ–¹èƒ½ åŒæ­¥å¼‚å¸¸ï¼š{e}")

        # å¤§å®¶å‘ â†’ æ–¹èƒ½
        try:
            self._run_dajiafa_to_fangneng()
        except Exception as e:
            print(f"âŒ å¤§å®¶å‘â†’æ–¹èƒ½ åŒæ­¥å¼‚å¸¸ï¼š{e}")

    # ===================== å¤©é¸¿â†’æ–¹èƒ½ ä¸»æµç¨‹ =====================
    def _run_tianhong_to_fangneng(self):
        th_host = self._get_value('å¤©é¸¿åŸŸå(port)').strip()
        th_cookie = self._get_value('å¤©é¸¿cookie').strip()

        fn_domain = self._get_value('æ–¹èƒ½åŸŸå').strip()
        fn_ua = self._get_value('user-agent').strip()
        fn_cookie = self._get_value('æ–¹èƒ½_cookie', is_text=True).strip()

        if not th_host or not th_cookie or not fn_domain or not fn_ua or not fn_cookie:
            self._send_telegram("âš ï¸ [å¤©é¸¿] é…ç½®ç¼ºå¤±ï¼Œè·³è¿‡æœ¬æ¬¡åŒæ­¥ã€‚")
            print("âš ï¸ [å¤©é¸¿] é…ç½®ç¼ºå¤±ï¼Œè·³è¿‡æœ¬æ¬¡åŒæ­¥ã€‚")
            return

        print("ğŸŸ¡ [å¤©é¸¿] å¼€å§‹æŠ“å–...")
        tianhong_url = f"https://{th_host}/user_Channel_index.html"
        th_headers = {'cookie': th_cookie}
        tianhong_map = {}  # {code: rate_decimal_4}

        try:
            html = self._http_get_text(tianhong_url, th_headers, verify=True)
            for code, rate_raw in self._tianhong_extract_rows(html):
                try:
                    rate_val = self._normalize_rate(rate_raw)  # ç»Ÿä¸€æ¢ç®—ä¸ºå››ä½å°æ•°æ¯”ä¾‹
                    tianhong_map[str(code).strip()] = rate_val
                except Exception as e:
                    print(f"âš ï¸ [å¤©é¸¿] è´¹ç‡è§£æå¤±è´¥ ({code}, {rate_raw}): {e}")
            print(f"âœ… [å¤©é¸¿] æŠ“å–å®Œæˆï¼Œé€šé“æ•°ï¼š{len(tianhong_map)}")
        except Exception as e:
            print(f"âŒ [å¤©é¸¿] æŠ“å–å¼‚å¸¸ï¼š{e}")

        if not tianhong_map:
            self._send_telegram("âš ï¸ [å¤©é¸¿] æŠ“å–ä¸ºç©ºï¼Œåœæ­¢æœ¬æ¬¡åŒæ­¥ã€‚")
            return

        self._diff_and_update_to_fangneng(
            supplier_name="å¤©é¸¿",
            target_map=tianhong_map,
            fn_domain=fn_domain,
            fn_ua=fn_ua,
            fn_cookie=fn_cookie
        )

    # ===================== å…¨åˆâ†’æ–¹èƒ½ ä¸»æµç¨‹ =====================
    def _run_quanhe_to_fangneng(self):
        qh_host = self._get_value('å…¨åˆåŸŸå(port)').strip()
        qh_cookie = self._get_value('å…¨åˆcookie').strip()

        fn_domain = self._get_value('æ–¹èƒ½åŸŸå').strip()
        fn_ua = self._get_value('user-agent').strip()
        fn_cookie = self._get_value('æ–¹èƒ½_cookie', is_text=True).strip()

        if not qh_host or not qh_cookie or not fn_domain or not fn_ua or not fn_cookie:
            self._send_telegram("âš ï¸ [å…¨åˆ] é…ç½®ç¼ºå¤±ï¼Œè·³è¿‡æœ¬æ¬¡åŒæ­¥ã€‚")
            print("âš ï¸ [å…¨åˆ] é…ç½®ç¼ºå¤±ï¼Œè·³è¿‡æœ¬æ¬¡åŒæ­¥ã€‚")
            return

        print("ğŸŸ¡ [å…¨åˆ] å¼€å§‹æŠ“å–...")
        quanhe_url = f"http://{qh_host}/agent_Channel_index.html"
        qh_headers = {'Cookie': qh_cookie}
        quanhe_map = {}  # {code: rate_decimal_4}

        try:
            html = self._http_get_text(quanhe_url, qh_headers, verify=False)
            for code, rate_raw in self._quanhe_extract_rows(html):
                try:
                    # æ”¯æŒâ€œ110 â€° / 150 â€° / 90 â€° / 55 â€° / 60 â€°â€ç­‰ï¼Œè‡ªåŠ¨æ¢ç®—ä¸ºå››ä½å°æ•°æ¯”ä¾‹
                    rate_val = self._normalize_rate(rate_raw)
                    quanhe_map[str(code).strip()] = rate_val
                except Exception as e:
                    print(f"âš ï¸ [å…¨åˆ] è´¹ç‡è§£æå¤±è´¥ ({code}, {rate_raw}): {e}")
            print(f"âœ… [å…¨åˆ] æŠ“å–å®Œæˆï¼Œé€šé“æ•°ï¼š{len(quanhe_map)}")
        except Exception as e:
            print(f"âŒ [å…¨åˆ] æŠ“å–å¼‚å¸¸ï¼š{e}")

        if not quanhe_map:
            self._send_telegram("âš ï¸ [å…¨åˆ] æŠ“å–ä¸ºç©ºï¼Œåœæ­¢æœ¬æ¬¡åŒæ­¥ã€‚")
            return

        self._diff_and_update_to_fangneng(
            supplier_name="å…¨åˆæ”¯ä»˜",
            target_map=quanhe_map,
            fn_domain=fn_domain,
            fn_ua=fn_ua,
            fn_cookie=fn_cookie
        )

    # ===================== å¤ªé˜³åŸâ†’æ–¹èƒ½ ä¸»æµç¨‹ =====================
    def _run_suncity_to_fangneng(self):
        sc_host = self._get_value('å¤ªé˜³åŸåŸŸå(port)').strip()
        sc_token = self._get_value('å¤ªé˜³åŸaccess_token').strip()

        fn_domain = self._get_value('æ–¹èƒ½åŸŸå').strip()
        fn_ua = self._get_value('user-agent').strip()
        fn_cookie = self._get_value('æ–¹èƒ½_cookie', is_text=True).strip()

        if not sc_host or not sc_token or not fn_domain or not fn_ua or not fn_cookie:
            self._send_telegram("âš ï¸ [å¤ªé˜³åŸ] é…ç½®ç¼ºå¤±ï¼Œè·³è¿‡æœ¬æ¬¡åŒæ­¥ã€‚")
            print("âš ï¸ [å¤ªé˜³åŸ] é…ç½®ç¼ºå¤±ï¼Œè·³è¿‡æœ¬æ¬¡åŒæ­¥ã€‚")
            return

        print("ğŸŸ¡ [å¤ªé˜³åŸ] å¼€å§‹æŠ“å–...")
        # å¤ªé˜³åŸæ¥å£ï¼ˆæ”¯æŒç¿»é¡µï¼›ä¸€æ¬¡æ‹‰100æ¡ï¼ŒæŒ‰éœ€ç¿»é¡µï¼‰
        base_url = f'http://{sc_host}/api/mch_pay_passage/list'
        headers = {
            'Accept': 'application/json, text/javascript, */*; q=0.01',
            'Accept-Language': 'zh-CN,zh;q=0.9,en;q=0.8',
            'Connection': 'keep-alive',
            'X-Requested-With': 'XMLHttpRequest',
        }

        suncity_map = {}  # {code: rate_decimal_4}
        page = 1
        limit = 100
        while True:
            params = {
                'page': str(page),
                'limit': str(limit),
                'access_token': sc_token,
            }
            try:
                resp = requests.get(base_url, params=params, headers=headers, verify=False, timeout=15)
                if resp.status_code != 200:
                    print(f"âŒ [å¤ªé˜³åŸ] HTTP {resp.status_code}ï¼š{resp.text[:200]}")
                    break
                js = resp.json() if resp.headers.get("content-type", "").lower().startswith("application/json") else {}
                data = js.get('data', []) or js.get('PageData', []) or []
                if not isinstance(data, list):
                    print("âš ï¸ [å¤ªé˜³åŸ] è¿”å›æ ¼å¼å¼‚å¸¸ï¼Œæœªè§æ•°ç»„ data")
                    break
                if not data:
                    break

                for row in data:
                    code = str(row.get('productId', '')).strip()
                    rate_raw = str(row.get('mchRate', '')).strip()
                    if not code or not rate_raw:
                        continue
                    try:
                        # è¿™é‡Œçš„ mchRate æ˜¯è£¸æ•°å­—ç™¾åˆ†æ¯”ï¼Œå¦‚ 13.0 -> 0.1300
                        rate_val = self._normalize_rate(rate_raw)
                        suncity_map[code] = rate_val
                    except Exception as e:
                        print(f"âš ï¸ [å¤ªé˜³åŸ] è´¹ç‡è§£æå¤±è´¥ ({code}, {rate_raw}): {e}")

                # ç¿»é¡µåˆ¤æ–­
                if len(data) < limit:
                    break
                page += 1
            except Exception as e:
                print(f"âš ï¸ [å¤ªé˜³åŸ] æŠ“å–å¼‚å¸¸ï¼š{e}")
                break

        print(f"âœ… [å¤ªé˜³åŸ] æŠ“å–å®Œæˆï¼Œé€šé“æ•°ï¼š{len(suncity_map)}")
        if not suncity_map:
            self._send_telegram("âš ï¸ [å¤ªé˜³åŸ] æŠ“å–ä¸ºç©ºï¼Œåœæ­¢æœ¬æ¬¡åŒæ­¥ã€‚")
            return

        # å†™å…¥æ–¹èƒ½ï¼ˆåœ¨æ–¹èƒ½ä¸­ï¼Œname=å¤ªé˜³åŸï¼‰
        self._diff_and_update_to_fangneng(
            supplier_name="å¤ªé˜³åŸ",
            target_map=suncity_map,
            fn_domain=fn_domain,
            fn_ua=fn_ua,
            fn_cookie=fn_cookie
        )

    # ===================== æ±‰åº­â†’æ–¹èƒ½ ä¸»æµç¨‹ =====================
    def _run_hanting_to_fangneng(self):
        ht_host = self._get_value('æ±‰åº­åŸŸå(port)').strip()
        ht_cookie = self._get_value('æ±‰åº­cookie').strip()

        fn_domain = self._get_value('æ–¹èƒ½åŸŸå').strip()
        fn_ua = self._get_value('user-agent').strip()
        fn_cookie = self._get_value('æ–¹èƒ½_cookie', is_text=True).strip()

        if not ht_host or not ht_cookie or not fn_domain or not fn_ua or not fn_cookie:
            self._send_telegram("âš ï¸ [æ±‰åº­] é…ç½®ç¼ºå¤±ï¼Œè·³è¿‡æœ¬æ¬¡åŒæ­¥ã€‚")
            print("âš ï¸ [æ±‰åº­] é…ç½®ç¼ºå¤±ï¼Œè·³è¿‡æœ¬æ¬¡åŒæ­¥ã€‚")
            return

        print("ğŸŸ¡ [æ±‰åº­] å¼€å§‹æŠ“å–...")
        hanting_url = f"http://{ht_host}/agent_Channel_index.html"
        ht_headers = {'Cookie': ht_cookie}
        hanting_map = {}  # {code: rate_decimal_4}

        try:
            html = self._http_get_text(hanting_url, ht_headers, verify=False)
            # ç›´æ¥å¤ç”¨â€œå…¨åˆâ€çš„è¡¨æ ¼è§£æå™¨ï¼ˆåŒç»“æ„ï¼‰
            for code, rate_raw in self._quanhe_extract_rows(html):
                try:
                    rate_val = self._normalize_rate(rate_raw)  # ç»Ÿä¸€è½¬æˆå››ä½å°æ•°æ¯”ä¾‹
                    hanting_map[str(code).strip()] = rate_val
                except Exception as e:
                    print(f"âš ï¸ [æ±‰åº­] è´¹ç‡è§£æå¤±è´¥ ({code}, {rate_raw}): {e}")
            print(f"âœ… [æ±‰åº­] æŠ“å–å®Œæˆï¼Œé€šé“æ•°ï¼š{len(hanting_map)}")
        except Exception as e:
            print(f"âŒ [æ±‰åº­] æŠ“å–å¼‚å¸¸ï¼š{e}")

        if not hanting_map:
            self._send_telegram("âš ï¸ [æ±‰åº­] æŠ“å–ä¸ºç©ºï¼Œåœæ­¢æœ¬æ¬¡åŒæ­¥ã€‚")
            return

        # å†™å›æ–¹èƒ½ï¼šæ³¨æ„ä¾›åº”å•†åç”¨â€œæ±‰åº­â€
        self._diff_and_update_to_fangneng(
            supplier_name="æ±‰åº­",
            target_map=hanting_map,
            fn_domain=fn_domain,
            fn_ua=fn_ua,
            fn_cookie=fn_cookie
        )

    # ===================== å°Šäº«â†’æ–¹èƒ½ ä¸»æµç¨‹ =====================
    def _run_xinzunxiang_to_fangneng(self):
        host = self._get_value('å°Šäº«åŸŸå(port)').strip()
        itoken = self._get_value('å°Šäº«itoken').strip()

        fn_domain = self._get_value('æ–¹èƒ½åŸŸå').strip()
        fn_ua = self._get_value('user-agent').strip()
        fn_cookie = self._get_value('æ–¹èƒ½_cookie', is_text=True).strip()

        if not host or not itoken or not fn_domain or not fn_ua or not fn_cookie:
            self._send_telegram("âš ï¸ [å°Šäº«] é…ç½®ç¼ºå¤±ï¼Œè·³è¿‡æœ¬æ¬¡åŒæ­¥ã€‚")
            print("âš ï¸ [å°Šäº«] é…ç½®ç¼ºå¤±ï¼Œè·³è¿‡æœ¬æ¬¡åŒæ­¥ã€‚")
            return

        print("ğŸŸ¡ [å°Šäº«] å¼€å§‹æŠ“å–...")
        base_url = f'https://{host}/api/mchApps'
        headers = {
            'accept': 'application/json, text/plain, */*',
            'itoken': itoken,  # å…³é”®ï¼šè®¤è¯æ”¾åœ¨è¯·æ±‚å¤´ itoken
        }

        xzx_map = {}  # {code: rate_decimal_4}
        page = 1
        page_size = 100
        while True:
            params = {'pageNumber': str(page), 'pageSize': str(page_size)}
            try:
                resp = requests.get(base_url, params=params, headers=headers, timeout=15)
                if resp.status_code != 200:
                    print(f"âŒ [å°Šäº«] HTTP {resp.status_code}ï¼š{resp.text[:200]}")
                    break

                js = resp.json()
                records = (js.get('data', {}) or {}).get('records', [])
                if not isinstance(records, list):
                    print("âš ï¸ [å°Šäº«] è¿”å›æ ¼å¼å¼‚å¸¸ï¼Œæœªè§æ•°ç»„ data.records")
                    break
                if not records:
                    break

                for row in records:
                    code = str(row.get('productId', '')).strip()
                    rate_raw = str(row.get('mchRate', '')).strip()
                    if not code or not rate_raw:
                        continue
                    try:
                        # è£¸æ•°å­—æŒ‰ç™¾åˆ†æ¯”ï¼š13.0 -> 0.1300ï¼›5.3 -> 0.0530
                        rate_val = self._normalize_rate(rate_raw)
                        xzx_map[code] = rate_val
                    except Exception as e:
                        print(f"âš ï¸ [å°Šäº«] è´¹ç‡è§£æå¤±è´¥ ({code}, {rate_raw}): {e}")

                if len(records) < page_size:
                    break
                page += 1

            except Exception as e:
                print(f"âš ï¸ [å°Šäº«] æŠ“å–å¼‚å¸¸ï¼š{e}")
                break

        print(f"âœ… [å°Šäº«] æŠ“å–å®Œæˆï¼Œé€šé“æ•°ï¼š{len(xzx_map)}")
        if not xzx_map:
            self._send_telegram("âš ï¸ [å°Šäº«] æŠ“å–ä¸ºç©ºï¼Œåœæ­¢æœ¬æ¬¡åŒæ­¥ã€‚")
            return

        # å†™å›æ–¹èƒ½ï¼šsupplier_name è¦ä¸æ–¹èƒ½åå°â€œä¾›åº”å•†åç§°â€ä¸€è‡´
        self._diff_and_update_to_fangneng(
            supplier_name="å°Šäº«",
            target_map=xzx_map,
            fn_domain=fn_domain,
            fn_ua=fn_ua,
            fn_cookie=fn_cookie
        )

    # ===================== æ˜“é€šâ†’æ–¹èƒ½ ä¸»æµç¨‹ =====================
    def _run_yitong_to_fangneng(self):
        yt_host = self._get_value('æ˜“é€šåŸŸå(port)').strip()
        yt_token = self._get_value('æ˜“é€šaccess_token').strip()

        fn_domain = self._get_value('æ–¹èƒ½åŸŸå').strip()
        fn_ua = self._get_value('user-agent').strip()
        fn_cookie = self._get_value('æ–¹èƒ½_cookie', is_text=True).strip()

        if not yt_host or not yt_token or not fn_domain or not fn_ua or not fn_cookie:
            self._send_telegram("âš ï¸ [æ˜“é€š] é…ç½®ç¼ºå¤±ï¼Œè·³è¿‡æœ¬æ¬¡åŒæ­¥ã€‚")
            print("âš ï¸ [æ˜“é€š] é…ç½®ç¼ºå¤±ï¼Œè·³è¿‡æœ¬æ¬¡åŒæ­¥ã€‚")
            return

        print("ğŸŸ¡ [æ˜“é€š] å¼€å§‹æŠ“å–...")
        base_url = f'http://{yt_host}/api/mch_pay_passage/list'
        headers = {
            'Accept': 'application/json, text/javascript, */*; q=0.01',
            'Accept-Language': 'zh-CN,zh;q=0.9,en;q=0.8',
            'Connection': 'keep-alive',
            'X-Requested-With': 'XMLHttpRequest',
        }

        yitong_map = {}  # {code: rate_decimal_4}
        page = 1
        limit = 100
        while True:
            params = {
                'page': str(page),
                'limit': str(limit),
                'access_token': yt_token,  # å…³é”®ï¼šä¸å¤ªé˜³åŸä¸€è‡´ï¼Œç”¨ query å‚æ•°
            }
            try:
                resp = requests.get(base_url, params=params, headers=headers, verify=False, timeout=15)
                if resp.status_code != 200:
                    print(f"âŒ [æ˜“é€š] HTTP {resp.status_code}ï¼š{resp.text[:200]}")
                    break

                js = resp.json() if resp.headers.get("content-type", "").lower().startswith("application/json") else {}
                data = js.get('data', []) or js.get('PageData', []) or []
                if not isinstance(data, list):
                    print("âš ï¸ [æ˜“é€š] è¿”å›æ ¼å¼å¼‚å¸¸ï¼Œæœªè§æ•°ç»„ data")
                    break
                if not data:
                    break

                for row in data:
                    code = str(row.get('productId', '')).strip()
                    rate_raw = str(row.get('mchRate', '')).strip()
                    if not code or not rate_raw:
                        continue
                    try:
                        # è£¸æ•°å­—æŒ‰ç™¾åˆ†æ¯”ï¼š13.0 -> 0.1300ï¼›5.5 -> 0.0550
                        rate_val = self._normalize_rate(rate_raw)
                        yitong_map[code] = rate_val
                    except Exception as e:
                        print(f"âš ï¸ [æ˜“é€š] è´¹ç‡è§£æå¤±è´¥ ({code}, {rate_raw}): {e}")

                if len(data) < limit:
                    break
                page += 1

            except Exception as e:
                print(f"âš ï¸ [æ˜“é€š] æŠ“å–å¼‚å¸¸ï¼š{e}")
                break

        print(f"âœ… [æ˜“é€š] æŠ“å–å®Œæˆï¼Œé€šé“æ•°ï¼š{len(yitong_map)}")
        if not yitong_map:
            self._send_telegram("âš ï¸ [æ˜“é€š] æŠ“å–ä¸ºç©ºï¼Œåœæ­¢æœ¬æ¬¡åŒæ­¥ã€‚")
            return

        # å†™å›æ–¹èƒ½ï¼šæ³¨æ„ supplier_name è¦ä¸æ–¹èƒ½åå°â€œä¾›åº”å•†åç§°â€ä¸€è‡´
        self._diff_and_update_to_fangneng(
            supplier_name="æ˜“é€š",
            target_map=yitong_map,
            fn_domain=self._get_value('æ–¹èƒ½åŸŸå').strip(),
            fn_ua=self._get_value('user-agent').strip(),
            fn_cookie=self._get_value('æ–¹èƒ½_cookie', is_text=True).strip()
        )

    # ===================== å…†é”‹â†’æ–¹èƒ½ ä¸»æµç¨‹ =====================
    def _run_zhaofeng_to_fangneng(self):
        zf_host = self._get_value('å…†é”‹åŸŸå(port)').strip()
        zf_token = self._get_value('å…†é”‹access_token').strip()

        fn_domain = self._get_value('æ–¹èƒ½åŸŸå').strip()
        fn_ua = self._get_value('user-agent').strip()
        fn_cookie = self._get_value('æ–¹èƒ½_cookie', is_text=True).strip()

        if not zf_host or not zf_token or not fn_domain or not fn_ua or not fn_cookie:
            self._send_telegram("âš ï¸ [å…†é”‹] é…ç½®ç¼ºå¤±ï¼Œè·³è¿‡æœ¬æ¬¡åŒæ­¥ã€‚")
            print("âš ï¸ [å…†é”‹] é…ç½®ç¼ºå¤±ï¼Œè·³è¿‡æœ¬æ¬¡åŒæ­¥ã€‚")
            return

        print("ğŸŸ¡ [å…†é”‹] å¼€å§‹æŠ“å–...")
        base_url = f'http://{zf_host}/api/mch_pay_passage/list'
        headers = {
            'Accept': 'application/json, text/javascript, */*; q=0.01',
            'Accept-Language': 'zh-CN,zh;q=0.9,en;q=0.8',
            'Connection': 'keep-alive',
            'X-Requested-With': 'XMLHttpRequest',
        }

        zhaofeng_map = {}  # {code: rate_decimal_4}
        page = 1
        limit = 100
        while True:
            params = {
                'page': str(page),
                'limit': str(limit),
                'access_token': zf_token,  # ä¸å¤ªé˜³åŸ/æ˜“é€šä¸€è‡´ï¼šquery ä¼  token
            }
            try:
                resp = requests.get(base_url, params=params, headers=headers, verify=False, timeout=15)
                if resp.status_code != 200:
                    print(f"âŒ [å…†é”‹] HTTP {resp.status_code}ï¼š{resp.text[:200]}")
                    break

                js = resp.json() if resp.headers.get("content-type", "").lower().startswith("application/json") else {}
                data = js.get('data', []) or js.get('PageData', []) or []
                if not isinstance(data, list):
                    print("âš ï¸ [å…†é”‹] è¿”å›æ ¼å¼å¼‚å¸¸ï¼Œæœªè§æ•°ç»„ data")
                    break
                if not data:
                    break

                for row in data:
                    code = str(row.get('productId', '')).strip()
                    rate_raw = str(row.get('mchRate', '')).strip()
                    if not code or not rate_raw:
                        continue
                    try:
                        # è£¸æ•°å­—æŒ‰ç™¾åˆ†æ¯”ï¼šå¦‚ 13.0 -> 0.1300ï¼›5.5 -> 0.0550
                        rate_val = self._normalize_rate(rate_raw)
                        zhaofeng_map[code] = rate_val
                    except Exception as e:
                        print(f"âš ï¸ [å…†é”‹] è´¹ç‡è§£æå¤±è´¥ ({code}, {rate_raw}): {e}")

                if len(data) < limit:
                    break
                page += 1

            except Exception as e:
                print(f"âš ï¸ [å…†é”‹] æŠ“å–å¼‚å¸¸ï¼š{e}")
                break

        print(f"âœ… [å…†é”‹] æŠ“å–å®Œæˆï¼Œé€šé“æ•°ï¼š{len(zhaofeng_map)}")
        if not zhaofeng_map:
            self._send_telegram("âš ï¸ [å…†é”‹] æŠ“å–ä¸ºç©ºï¼Œåœæ­¢æœ¬æ¬¡åŒæ­¥ã€‚")
            return

        # å†™å›æ–¹èƒ½ï¼šsupplier_name è¦ä¸æ–¹èƒ½åå°â€œä¾›åº”å•†åç§°â€ä¸€è‡´
        self._diff_and_update_to_fangneng(
            supplier_name="å…†é”‹",
            target_map=zhaofeng_map,
            fn_domain=fn_domain,
            fn_ua=fn_ua,
            fn_cookie=fn_cookie
        )

    # ===================== å¤§å®¶å‘â†’æ–¹èƒ½ ä¸»æµç¨‹ =====================
    def _run_dajiafa_to_fangneng(self):
        dajiafa_host = self._get_value('å¤§å®¶å‘åŸŸå(port)').strip()
        dajiafa_token = self._get_value('å¤§å®¶å‘access_token').strip()

        fn_domain = self._get_value('æ–¹èƒ½åŸŸå').strip()
        fn_ua = self._get_value('user-agent').strip()
        fn_cookie = self._get_value('æ–¹èƒ½_cookie', is_text=True).strip()

        if not dajiafa_host or not dajiafa_token or not fn_domain or not fn_ua or not fn_cookie:
            self._send_telegram("âš ï¸ [å¤§å®¶å‘] é…ç½®ç¼ºå¤±ï¼Œè·³è¿‡æœ¬æ¬¡åŒæ­¥ã€‚")
            print("âš ï¸ [å¤§å®¶å‘] é…ç½®ç¼ºå¤±ï¼Œè·³è¿‡æœ¬æ¬¡åŒæ­¥ã€‚")
            return

        print("ğŸŸ¡ [å¤§å®¶å‘] å¼€å§‹æŠ“å–...")
        base_url = f'http://{dajiafa_host}/api/mch_pay_passage/list'
        headers = {
            'Accept': 'application/json, text/javascript, */*; q=0.01',
            'Accept-Language': 'zh-CN,zh;q=0.9,en;q=0.8',
            'Connection': 'keep-alive',
            'X-Requested-With': 'XMLHttpRequest',
        }

        dajiafa_map = {}  # {code: rate_decimal_4}
        page = 1
        limit = 100
        while True:
            params = {
                'page': str(page),
                'limit': str(limit),
                'access_token': dajiafa_token,  # ä¸å¤ªé˜³åŸ/æ˜“é€šä¸€è‡´ï¼šquery ä¼  token
            }
            try:
                resp = requests.get(base_url, params=params, headers=headers, verify=False, timeout=15)
                if resp.status_code != 200:
                    print(f"âŒ [å¤§å®¶å‘] HTTP {resp.status_code}ï¼š{resp.text[:200]}")
                    break

                js = resp.json() if resp.headers.get("content-type", "").lower().startswith("application/json") else {}
                data = js.get('data', []) or js.get('PageData', []) or []
                if not isinstance(data, list):
                    print("âš ï¸ [å¤§å®¶å‘] è¿”å›æ ¼å¼å¼‚å¸¸ï¼Œæœªè§æ•°ç»„ data")
                    break
                if not data:
                    break

                for row in data:
                    code = str(row.get('productId', '')).strip()
                    rate_raw = str(row.get('mchRate', '')).strip()
                    if not code or not rate_raw:
                        continue
                    try:
                        # è£¸æ•°å­—æŒ‰ç™¾åˆ†æ¯”ï¼šå¦‚ 13.0 -> 0.1300ï¼›5.5 -> 0.0550
                        rate_val = self._normalize_rate(rate_raw)
                        dajiafa_map[code] = rate_val
                    except Exception as e:
                        print(f"âš ï¸ [å¤§å®¶å‘] è´¹ç‡è§£æå¤±è´¥ ({code}, {rate_raw}): {e}")

                if len(data) < limit:
                    break
                page += 1

            except Exception as e:
                print(f"âš ï¸ [å¤§å®¶å‘] æŠ“å–å¼‚å¸¸ï¼š{e}")
                break

        print(f"âœ… [å¤§å®¶å‘] æŠ“å–å®Œæˆï¼Œé€šé“æ•°ï¼š{len(dajiafa_map)}")
        if not dajiafa_map:
            self._send_telegram("âš ï¸ [å¤§å®¶å‘] æŠ“å–ä¸ºç©ºï¼Œåœæ­¢æœ¬æ¬¡åŒæ­¥ã€‚")
            return

        # å†™å›æ–¹èƒ½ï¼šsupplier_name è¦ä¸æ–¹èƒ½åå°â€œä¾›åº”å•†åç§°â€ä¸€è‡´
        self._diff_and_update_to_fangneng(
            supplier_name="å¤§å®¶å‘",
            target_map=dajiafa_map,
            fn_domain=fn_domain,
            fn_ua=fn_ua,
            fn_cookie=fn_cookie
        )

    # ===================== é€šç”¨ï¼šæ¯”å¯¹å¹¶æ›´æ–°åˆ°æ–¹èƒ½ =====================
    def _diff_and_update_to_fangneng(self, supplier_name: str, target_map: dict, fn_domain: str, fn_ua: str,
                                     fn_cookie: str):
        print(f"ğŸŸ¡ [æ–¹èƒ½] å¼€å§‹æŸ¥è¯¢â€œ{supplier_name}â€é€šé“...")
        æŸ¥è¯¢æ¥å£ = f'https://{fn_domain}/PassManage/Pass/GetPageListJson'
        æ›´æ–°æ¥å£ = f'https://{fn_domain}/PassManage/Pass/EditChannelTypeConf'
        headers_fn = {'cookie': fn_cookie, 'user-agent': fn_ua, 'x-requested-with': 'XMLHttpRequest'}

        # æ‹‰å–æ–¹èƒ½â€œsupplier_nameâ€åä¸‹é€šé“
        fangneng_items = {}
        page, limit = 1, 100
        while True:
            params = {'page': str(page), 'limit': str(limit), 'name': supplier_name, 'tGGroupId': '', 'state': '1'}
            try:
                r = requests.get(æŸ¥è¯¢æ¥å£, params=params, headers=headers_fn, timeout=12)
                if r.status_code != 200:
                    print(f"âŒ [æ–¹èƒ½] æŸ¥è¯¢å¤±è´¥ï¼ŒçŠ¶æ€ç : {r.status_code}")
                    break
                js = r.json()
                page_data = js.get('PageData', []) or js.get('data', []) or []
                if not page_data:
                    break
                for it in page_data:
                    ch_type = str(it.get('ChannelType', '')).strip()
                    if ch_type:
                        fangneng_items[ch_type] = it
                if len(page_data) < limit:
                    break
                page += 1
            except Exception as e:
                print(f"âš ï¸ [æ–¹èƒ½] æŸ¥è¯¢å¼‚å¸¸ï¼š{e}")
                break

        print(f"âœ… [æ–¹èƒ½] å‘½ä¸­â€œ{supplier_name}â€é€šé“æ•°ï¼š{len(fangneng_items)}")
        if not fangneng_items:
            self._send_telegram(f"âš ï¸ [æ–¹èƒ½] æœªæ‰¾åˆ°åç§°ä¸ºâ€œ{supplier_name}â€çš„é€šé“ã€‚")
            return

        # æ¯”å¯¹å¹¶æ›´æ–°
        print("ğŸŸ¡ å¼€å§‹é€æ¡æ›´æ–°ï¼ˆä»…è´¹ç‡ä¸ä¸€è‡´æ‰æ›´æ–°ï¼Œé—´éš”1ç§’ï¼‰...")
        æˆåŠŸæ•°é‡ = 0
        è·³è¿‡æ•°é‡ = 0
        æœªåŒ¹é…æ•°é‡ = 0
        æˆåŠŸåˆ—è¡¨ = []

        for ch_code, item in fangneng_items.items():
            target_rate = target_map.get(ch_code)
            if target_rate is None:
                æœªåŒ¹é…æ•°é‡ += 1
                print(f"â­ [æœªåŒ¹é…] æ–¹èƒ½æœ‰ç¼–ç  {ch_code}ï¼Œæ¥æºâ€œ{supplier_name}â€æœªæä¾›ï¼Œè·³è¿‡")
                continue

            current_rate_raw = str(item.get('PassChannelTypeConfRate', '')).strip()
            try:
                current_rate = self._normalize_rate(current_rate_raw)
            except Exception as e:
                print(f"âš ï¸ [è´¹ç‡å¼‚å¸¸] ç¼–ç  {ch_code} å½“å‰è´¹ç‡æ— æ³•è§£æ({current_rate_raw})ï¼š{e}ï¼Œè·³è¿‡")
                è·³è¿‡æ•°é‡ += 1
                continue

            if round(current_rate, 4) == round(target_rate, 4):
                print(f"â­ ç¼–ç  {ch_code} è´¹ç‡ä¸€è‡´ï¼ˆ{current_rate:.4f}ï¼‰ï¼Œè·³è¿‡")
                è·³è¿‡æ•°é‡ += 1
                continue

            payload = {
                'Id': item.get('PassChannelTypeConfId'),
                'Status': '1',
                'PassId': '',
                'remark': item.get('PassCodeName'),
                'Rate': f"{target_rate:.4f}",  # å°æ•°å½¢å¼ï¼Œå››ä½
                'AmountRange': item.get('AmountRange'),
                'ChannelType': item.get('ChannelType'),
                'AgentRate': '0',
            }
            try:
                res = requests.post(æ›´æ–°æ¥å£, data=payload, headers=headers_fn, timeout=12)
                if res.status_code == 200:
                    æˆåŠŸæ•°é‡ += 1
                    æˆåŠŸåˆ—è¡¨.append(f"{ch_code} {current_rate:.4f} â†’ {target_rate:.4f}")
                    print(f"âœ… ç¼–ç  {ch_code} æ›´æ–°æˆåŠŸï¼š{current_rate:.4f} â†’ {target_rate:.4f}")
                else:
                    print(f"âŒ æ›´æ–°å¤±è´¥ ç¼–ç  {ch_code}ï¼ŒHTTP {res.status_code}ï¼Œè¿”å›ï¼š{res.text[:200]}")
                time.sleep(1)
            except Exception as e:
                print(f"âš ï¸ æ›´æ–°å¼‚å¸¸ ç¼–ç  {ch_code}ï¼š{e}")

        æ˜ç»†æ–‡æœ¬ = "æ— " if not æˆåŠŸåˆ—è¡¨ else "\n".join(æˆåŠŸåˆ—è¡¨[:50])
        msg = (
            f"ğŸ“¢ *{supplier_name}â†’æ–¹èƒ½ è´¹ç‡åŒæ­¥å®Œæˆ*\n"
            f"âœ… æˆåŠŸæ›´æ–°ï¼š*{æˆåŠŸæ•°é‡}*\n"
            f"â­ è´¹ç‡ä¸€è‡´è·³è¿‡ï¼š*{è·³è¿‡æ•°é‡}*\n"
            f"â“ æ–¹èƒ½æœ‰ä½†æ¥æºæ— ï¼ˆè·³è¿‡ï¼‰ï¼š*{æœªåŒ¹é…æ•°é‡}*\n"
            f"ğŸ“¦ æ–¹èƒ½â€œ{supplier_name}â€é€šé“æ€»æ•°ï¼š*{len(fangneng_items)}*\n"
            f"ğŸ§¾ æ›´æ–°æ˜ç»†ï¼ˆå‰50æ¡ï¼‰ï¼š\n{æ˜ç»†æ–‡æœ¬}\n"
            f"â° æ—¶é—´ï¼š{time.strftime('%Y-%m-%d %H:%M:%S')}"
        )
        if æˆåŠŸæ•°é‡ > 0:
            self._send_telegram(msg)

        # UI æç¤º
        def show_finish():
            QMessageBox.information(
                self, f"{supplier_name}â†’æ–¹èƒ½ å®Œæˆ",
                f"âœ… æˆåŠŸæ›´æ–°ï¼š{æˆåŠŸæ•°é‡} æ¡\n"
                f"â­ è´¹ç‡ä¸€è‡´ï¼š{è·³è¿‡æ•°é‡} æ¡\n"
                f"â“ æ–¹èƒ½æœ‰ä½†æ¥æºæ— ï¼š{æœªåŒ¹é…æ•°é‡} æ¡\n"
                f"ğŸ“¦ æ–¹èƒ½â€œ{supplier_name}â€é€šé“ï¼š{len(fangneng_items)} æ¡"
            )

        QTimer.singleShot(0, show_finish)

    # ===================== å¤©é¸¿æŠ“å–å·¥å…· =====================
    @staticmethod
    def _http_get_text(url: str, headers: dict, verify: bool) -> str:
        resp = requests.get(url, headers=headers, verify=verify, timeout=20)
        resp.raise_for_status()
        if not resp.encoding or resp.encoding.lower() == "iso-8859-1":
            resp.encoding = resp.apparent_encoding or "utf-8"
        return resp.text

    @staticmethod
    def _tianhong_extract_rows(html: str):
        """
        è§£æå¤©é¸¿è¡¨æ ¼ï¼Œè¿”å› (é€šé“ç¼–ç , è´¹ç‡å­—ç¬¦ä¸²)ï¼Œå¦‚ ('2008', '17.5%')
        """
        soup = BeautifulSoup(html, "html.parser")
        tables = soup.select("table.layui-table")
        for tbl in tables:
            thead = tbl.find("thead")
            if not thead:
                continue
            head_text = " ".join(thead.get_text(separator=" ", strip=True).split())
            if all(k in head_text for k in ["é€šé“ç¼–ç ", "é€šé“è´¹ç‡"]):
                tbody = tbl.find("tbody")
                if not tbody:
                    continue
                for tr in tbody.find_all("tr"):
                    tds = tr.find_all("td")
                    if len(tds) < 3:
                        continue
                    code = tds[0].get_text(strip=True)
                    rate = tds[2].get_text(strip=True)
                    if code:
                        yield code, rate

    # ===================== å…¨åˆæŠ“å–å·¥å…· =====================
    @staticmethod
    def _quanhe_extract_rows(html: str):
        """
        è§£æå…¨åˆé¡µé¢ä»»æ„åŒ…å«â€œç¼–ç /è´¹ç‡â€çš„è¡¨æ ¼ï¼Œè¿”å› (å•†æˆ·ç¼–ç , è´¹ç‡å­—ç¬¦ä¸²)
        ä¾‹ï¼š'6666 110 â€°'ã€'8001 150 â€°' ç­‰
        """
        soup = BeautifulSoup(html, "html.parser")
        for tbl in soup.select("table"):
            thead = tbl.find("thead")
            if not thead:
                continue
            ths = [(" ".join(th.get_text(strip=True).split())) for th in thead.find_all("th")]
            idx_code = None
            idx_rate = None
            for i, t in enumerate(ths):
                if t in ("ç¼–ç ", "é€šé“ç¼–ç "):
                    idx_code = i
                if ("è´¹ç‡" in t) or ("é€šé“è´¹ç‡" in t):
                    idx_rate = i
            if idx_code is None or idx_rate is None:
                continue

            tbody = tbl.find("tbody")
            if not tbody:
                continue

            for tr in tbody.find_all("tr"):
                tds = tr.find_all("td")
                if len(tds) <= max(idx_code, idx_rate):
                    continue
                code = tds[idx_code].get_text(strip=True)
                rate_raw = tds[idx_rate].get_text(strip=True)
                rate_norm = " ".join(rate_raw.split())  # è§„èŒƒç©ºç™½ï¼Œä¿ç•™â€œâ€°â€
                if code and rate_norm:
                    yield code, rate_norm
            # æ‰¾åˆ°é¦–ä¸ªåŒ¹é…è¡¨åå³å¯ç»“æŸ
            break

    # ===================== è´¹ç‡ç»Ÿä¸€æ¢ç®—ï¼šå››ä½å°æ•° =====================
    @staticmethod
    def _normalize_rate(rate_str: str) -> float:
        """
        æ”¯æŒï¼š
          - '17.5%' / '17%' / '17.5 %'  -> 0.1750
          - '110 â€°' / '110â€°' / '150 â€°' -> 0.1100 / 0.1500
          - '0.175'ï¼ˆå°æ•°ï¼‰              -> 0.1750
          - '17.5'ï¼ˆè£¸æ•°ï¼ŒæŒ‰ç™¾åˆ†æ¯”ï¼‰     -> 0.1750
        """
        s = (rate_str or "").strip()
        s = s.replace(',', '')  # å»åƒåˆ†ä½é€—å·
        # æœ‰åƒåˆ†å·
        if 'â€°' in s:
            num = s.replace('â€°', '').strip()
            v = float(num) / 1000.0
            return round(v, 4)
        # æœ‰ç™¾åˆ†å·
        if s.endswith('%') or s.endswith(' %'):
            num = s.replace('%', '').strip()
            v = float(num) / 100.0
            return round(v, 4)
        # çº¯æ•°å­—ï¼šåˆ¤æ–­æ˜¯å¦å½“æˆç™¾åˆ†æ¯”ï¼ˆä¸åŸç¨‹åºä¿æŒä¸€è‡´ï¼šè£¸æ•°æŒ‰ç™¾åˆ†æ¯”ï¼‰
        # è‹¥å·²æ˜¯å°æ•°ï¼Œå¦‚ 0.175 -> ç›´æ¥å››èˆäº”å…¥
        try:
            val = float(s)
            if val > 1:  # å½¢å¦‚ 17.5 -> 17.5%
                return round(val / 100.0, 4)
            return round(val, 4)
        except:
            # å†å°è¯•ï¼šæå–æ•°å­—+å¯é€‰å°æ•°
            m = re.search(r'(-?\d+(?:\.\d+)?)', s)
            if not m:
                raise ValueError(f"æ— æ³•è§£æè´¹ç‡ï¼š{rate_str}")
            val = float(m.group(1))
            if ('â€°' in rate_str):
                return round(val / 1000.0, 4)
            return round((val / 100.0 if val > 1 else val), 4)


if __name__ == '__main__':
    app = QApplication(sys.argv)
    w = App()
    w.show()
    sys.exit(app.exec_())
